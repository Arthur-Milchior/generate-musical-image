import unittest
from instruments.piano.piano_note import PianoNote


class TestPianoNote.make(unittest.TestCase):
    def test_lily(self):
        self.assertEqual(PianoNote.make(chromatic=0, diatonic=0, finger=1).lily_key(), "c'-1")

    def test_next_finger(self):
        for adjacent in (True, False):
            for pinky_side in range(1, 6):
                for thumb_side in PianoNote.from_name("C", finger=pinky_side).valid_next_fingers_in_thumb_direction(adjacent):
                    self.assertTrue(
                        pinky_side in PianoNote.from_name("C", finger=thumb_side).valid_next_fingers_in_pinky_direction(adjacent))
            for thumb_side in range(1, 6):
                for pinky_side in PianoNote.from_name("C", finger=thumb_side).valid_next_fingers_in_pinky_direction(adjacent):
                    self.assertTrue(
                        thumb_side in PianoNote.from_name("C", finger=pinky_side).valid_next_fingers_in_thumb_direction(adjacent))

    def test_valid_next_fingers_for_same_note(self):
        self.assertEqual(PianoNote.from_name("C", finger=1).valid_next_fingers_for_same_note(), [1, 2])
        self.assertEqual(PianoNote.from_name("C", finger=2).valid_next_fingers_for_same_note(), [1, 2, 3])
        self.assertEqual(PianoNote.from_name("C", finger=3).valid_next_fingers_for_same_note(), [2, 3, 4])
        self.assertEqual(PianoNote.from_name("C", finger=4).valid_next_fingers_for_same_note(), [3, 4, 5])
        self.assertEqual(PianoNote.from_name("C", finger=5).valid_next_fingers_for_same_note(), [4, 5])

    def test_valid_next_finger_pinky_side(self):
        self.assertEqual(PianoNote.from_name("C", finger=1).valid_next_fingers_in_pinky_direction(adjacent=True), [2])
        self.assertEqual(PianoNote.from_name("C", finger=2).valid_next_fingers_in_pinky_direction(adjacent=True), [3, 1])
        self.assertEqual(PianoNote.from_name("C", finger=3).valid_next_fingers_in_pinky_direction(adjacent=True), [4, 1])
        self.assertEqual(PianoNote.from_name("C", finger=4).valid_next_fingers_in_pinky_direction(adjacent=True), [5, 1])
        self.assertEqual(PianoNote.from_name("C", finger=5).valid_next_fingers_in_pinky_direction(adjacent=True), [])
        self.assertEqual(PianoNote.from_name("C", finger=1).valid_next_fingers_in_pinky_direction(adjacent=False), [2, 3, 4, 5])
        self.assertEqual(PianoNote.from_name("C", finger=2).valid_next_fingers_in_pinky_direction(adjacent=False), [3, 1, 4, 5])
        self.assertEqual(PianoNote.from_name("C", finger=3).valid_next_fingers_in_pinky_direction(adjacent=False), [4, 1, 5])
        self.assertEqual(PianoNote.from_name("C", finger=4).valid_next_fingers_in_pinky_direction(adjacent=False), [5, 1])
        self.assertEqual(PianoNote.from_name("C", finger=5).valid_next_fingers_in_pinky_direction(adjacent=False), [])

    def test_valid_next_finger_thumb_side(self):
        self.assertEqual(PianoNote.from_name("C", finger=1).valid_next_fingers_in_thumb_direction(adjacent=True), [2, 3, 4])
        self.assertEqual(PianoNote.from_name("C", finger=2).valid_next_fingers_in_thumb_direction(adjacent=True), [1])
        self.assertEqual(PianoNote.from_name("C", finger=3).valid_next_fingers_in_thumb_direction(adjacent=True), [2])
        self.assertEqual(PianoNote.from_name("C", finger=4).valid_next_fingers_in_thumb_direction(adjacent=True), [3])
        self.assertEqual(PianoNote.from_name("C", finger=5).valid_next_fingers_in_thumb_direction(adjacent=True), [4])
        self.assertEqual(PianoNote.from_name("C", finger=1).valid_next_fingers_in_thumb_direction(adjacent=False), [2, 3, 4])
        self.assertEqual(PianoNote.from_name("C", finger=2).valid_next_fingers_in_thumb_direction(adjacent=False), [1])
        self.assertEqual(PianoNote.from_name("C", finger=3).valid_next_fingers_in_thumb_direction(adjacent=False), [1, 2])
        self.assertEqual(PianoNote.from_name("C", finger=4).valid_next_fingers_in_thumb_direction(adjacent=False), [1, 2, 3])
        self.assertEqual(PianoNote.from_name("C", finger=5).valid_next_fingers_in_thumb_direction(adjacent=False), [1, 2, 3, 4])

    def test_valid_next_fingers(self):
        # same note
        self.assertEqual(PianoNote.from_name("C", finger=1).valid_next_fingers(Note.from_name("C"), for_right_hand=True), [1, 2])
        self.assertEqual(PianoNote.from_name("C", finger=2).valid_next_fingers(Note.from_name("C"), for_right_hand=True), [1, 2, 3])
        self.assertEqual(PianoNote.from_name("C", finger=3).valid_next_fingers(Note.from_name("C"), for_right_hand=True), [2, 3, 4])
        self.assertEqual(PianoNote.from_name("C", finger=4).valid_next_fingers(Note.from_name("C"), for_right_hand=True), [3, 4, 5])
        self.assertEqual(PianoNote.from_name("C", finger=5).valid_next_fingers(Note.from_name("C"), for_right_hand=True), [4, 5])
        self.assertEqual(PianoNote.from_name("C", finger=1).valid_next_fingers(Note.from_name("C"), for_right_hand=False), [1, 2])
        self.assertEqual(PianoNote.from_name("C", finger=2).valid_next_fingers(Note.from_name("C"), for_right_hand=False), [1, 2, 3])
        self.assertEqual(PianoNote.from_name("C", finger=3).valid_next_fingers(Note.from_name("C"), for_right_hand=False), [2, 3, 4])
        self.assertEqual(PianoNote.from_name("C", finger=4).valid_next_fingers(Note.from_name("C"), for_right_hand=False), [3, 4, 5])
        self.assertEqual(PianoNote.from_name("C", finger=5).valid_next_fingers(Note.from_name("C"), for_right_hand=False), [4, 5])

        # pinky side
        self.assertEqual(PianoNote.from_name("C", finger=1).valid_next_fingers(Note.from_name("B3"), for_right_hand=False), [2])
        self.assertEqual(PianoNote.from_name("C", finger=2).valid_next_fingers(Note.from_name("B3"), for_right_hand=False), [3, 1])
        self.assertEqual(PianoNote.from_name("C", finger=3).valid_next_fingers(Note.from_name("B3"), for_right_hand=False), [4, 1])
        self.assertEqual(PianoNote.from_name("C", finger=4).valid_next_fingers(Note.from_name("B3"), for_right_hand=False), [5, 1])
        self.assertEqual(PianoNote.from_name("C", finger=5).valid_next_fingers(Note.from_name("B3"), for_right_hand=False), [])
        self.assertEqual(PianoNote.from_name("C", finger=1).valid_next_fingers(Note.from_name("A3"), for_right_hand=False), [2, 3, 4, 5])
        self.assertEqual(PianoNote.from_name("C", finger=2).valid_next_fingers(Note.from_name("A3"), for_right_hand=False), [3, 1, 4, 5])
        self.assertEqual(PianoNote.from_name("C", finger=3).valid_next_fingers(Note.from_name("A3"), for_right_hand=False), [4, 1, 5])
        self.assertEqual(PianoNote.from_name("C", finger=4).valid_next_fingers(Note.from_name("A3"), for_right_hand=False), [5, 1])
        self.assertEqual(PianoNote.from_name("C", finger=5).valid_next_fingers(Note.from_name("A3"), for_right_hand=False), [])

        self.assertEqual(PianoNote.from_name("C", finger=1).valid_next_fingers(Note.from_name("D"), for_right_hand=True), [2])
        self.assertEqual(PianoNote.from_name("C", finger=2).valid_next_fingers(Note.from_name("D"), for_right_hand=True), [3, 1])
        self.assertEqual(PianoNote.from_name("C", finger=3).valid_next_fingers(Note.from_name("D"), for_right_hand=True), [4, 1])
        self.assertEqual(PianoNote.from_name("C", finger=4).valid_next_fingers(Note.from_name("D"), for_right_hand=True), [5, 1])
        self.assertEqual(PianoNote.from_name("C", finger=5).valid_next_fingers(Note.from_name("D"), for_right_hand=True), [])
        self.assertEqual(PianoNote.from_name("C", finger=1).valid_next_fingers(Note.from_name("E"), for_right_hand=True), [2, 3, 4, 5])
        self.assertEqual(PianoNote.from_name("C", finger=2).valid_next_fingers(Note.from_name("E"), for_right_hand=True), [3, 1, 4, 5])
        self.assertEqual(PianoNote.from_name("C", finger=3).valid_next_fingers(Note.from_name("E"), for_right_hand=True), [4, 1, 5])
        self.assertEqual(PianoNote.from_name("C", finger=4).valid_next_fingers(Note.from_name("E"), for_right_hand=True), [5, 1])
        self.assertEqual(PianoNote.from_name("C", finger=5).valid_next_fingers(Note.from_name("E"), for_right_hand=True), [])

        # thumb side
        self.assertEqual(PianoNote.from_name("C", finger=1).valid_next_fingers(Note.from_name("D"), for_right_hand=False), [2, 3, 4])
        self.assertEqual(PianoNote.from_name("C", finger=2).valid_next_fingers(Note.from_name("D"), for_right_hand=False), [1])
        self.assertEqual(PianoNote.from_name("C", finger=3).valid_next_fingers(Note.from_name("D"), for_right_hand=False), [2])
        self.assertEqual(PianoNote.from_name("C", finger=4).valid_next_fingers(Note.from_name("D"), for_right_hand=False), [3])
        self.assertEqual(PianoNote.from_name("C", finger=5).valid_next_fingers(Note.from_name("D"), for_right_hand=False), [4])
        self.assertEqual(PianoNote.from_name("C", finger=1).valid_next_fingers(Note.from_name("E"), for_right_hand=False), [2, 3, 4])
        self.assertEqual(PianoNote.from_name("C", finger=2).valid_next_fingers(Note.from_name("E"), for_right_hand=False), [1])
        self.assertEqual(PianoNote.from_name("C", finger=3).valid_next_fingers(Note.from_name("E"), for_right_hand=False), [1, 2])
        self.assertEqual(PianoNote.from_name("C", finger=4).valid_next_fingers(Note.from_name("E"), for_right_hand=False), [1, 2, 3])
        self.assertEqual(PianoNote.from_name("C", finger=5).valid_next_fingers(Note.from_name("E"), for_right_hand=False), [1, 2, 3, 4])

        self.assertEqual(PianoNote.from_name("C", finger=1).valid_next_fingers(Note.from_name("B3"), for_right_hand=True), [2, 3, 4])
        self.assertEqual(PianoNote.from_name("C", finger=2).valid_next_fingers(Note.from_name("B3"), for_right_hand=True), [1])
        self.assertEqual(PianoNote.from_name("C", finger=3).valid_next_fingers(Note.from_name("B3"), for_right_hand=True), [2])
        self.assertEqual(PianoNote.from_name("C", finger=4).valid_next_fingers(Note.from_name("B3"), for_right_hand=True), [3])
        self.assertEqual(PianoNote.from_name("C", finger=5).valid_next_fingers(Note.from_name("B3"), for_right_hand=True), [4])
        self.assertEqual(PianoNote.from_name("C", finger=1).valid_next_fingers(Note.from_name("A3"), for_right_hand=True), [2, 3, 4])
        self.assertEqual(PianoNote.from_name("C", finger=2).valid_next_fingers(Note.from_name("A3"), for_right_hand=True), [1])
        self.assertEqual(PianoNote.from_name("C", finger=3).valid_next_fingers(Note.from_name("A3"), for_right_hand=True), [1, 2])
        self.assertEqual(PianoNote.from_name("C", finger=4).valid_next_fingers(Note.from_name("A3"), for_right_hand=True), [1, 2, 3])
        self.assertEqual(PianoNote.from_name("C", finger=5).valid_next_fingers(Note.from_name("A3"), for_right_hand=True), [1, 2, 3, 4])